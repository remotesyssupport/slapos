[buildout]
extends =
  ../dcron/instance.cfg 881e83a66b06a1f9e371c0334ad6973b

[logrotate_d]
recipe = slapos.cookbook:mkdir
name = logrotate.d
type = config_parts
removable = false

[logrotate_backup]
recipe = slapos.cookbook:mkdir
name = logrotate
type = backup
removable = false

[logrotate_conf]
recipe = slapos.cookbook:format
filename = logrotate
source = ${logrotate_conf:location}/${logrotate_conf:filename}
location = ${dollar}{buildout:directory}/etc/
substitute_logrotate_d = ${dollar}{logrotate_d:location}

[logrotate_bin]
recipe = slapos.cookbook:runner
service = no
cmd_0 = ${logrotate:location}/usr/sbin/logrotate
cmd_10 = -s
cmd_11 = ${dollar}{logrotate_data:location}/logrotate.status
cmd_50 = ${dollar}{logrotate_conf:location}/${dollar}{logrotate_conf:filename}
name = logrotate

[logrotate_data]
recipe = slapos.cookbook:mkdir
name = logrotate
type = data
removable = false

[logrotate]
recipe = slapos.cookbook:format
filename = logrotate
source = ${cron_d:location}/${cron_d:filename}
location = ${dollar}{cron_d:location}
substitute_min = 0
substitute_hour = 0
substitute_day = *
substitute_month = *
substitute_dow = *
substitute_command = ${dollar}{logrotate_bin:location}/${dollar}{logrotate_bin:name}
